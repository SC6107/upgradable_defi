# Lending Interface

去中心化借贷协议的前端界面，支持资产存款、借款、取款和还款。

## 功能特性

### 核心功能
- **资产存款**: 存入支持的资产赚取利息
- **资产借款**: 以存款作为抵押借出其他资产
- **资产取款**: 随时取出存款资产
- **债务还款**: 偿还借款并释放抵押品

### 市场功能
- 查看所有可用借贷市场
- 实时APY显示
- 市场利用率监控
- 总锁仓价值(TVL)统计

### 用户功能
- 查看个人持仓
- 监控账户健康度
- 追踪存款和借款余额
- 实时计算借款额度

## 目录结构

```
lending/
├── App.tsx                 # 主应用组件
├── types.ts               # TypeScript类型定义
├── components/            # UI组件
│   ├── Header.tsx        # 导航栏和钱包连接
│   ├── MarketsTable.tsx  # 市场列表
│   ├── UserPositions.tsx # 用户持仓
│   ├── ActionModal.tsx   # 操作模态框
│   └── index.ts          # 组件导出
├── hooks/                # React Hooks
│   └── useLending.ts     # 数据获取和钱包hooks
└── services/             # 服务层
    ├── api.ts           # API服务
    └── web3.ts          # Web3服务
```

## 组件说明

### App.tsx
主应用组件，整合所有功能模块：
- 市场展示
- 用户持仓管理
- 统计数据展示
- 操作流程控制

### MarketsTable
显示所有借贷市场的表格：
- 资产信息
- 存款/借款APY
- 市场利用率
- 快速操作按钮

### UserPositions
用户持仓管理界面：
- 存款持仓列表
- 借款持仓列表
- 账户健康度监控
- 快速取款/还款

### ActionModal
通用操作模态框：
- 存款
- 取款
- 借款
- 还款

## 使用流程

### 1. 连接钱包
点击右上角"连接钱包"按钮，授权MetaMask连接。

### 2. 存款赚息
1. 在"市场"标签页选择要存入的资产
2. 点击"存款"按钮
3. 输入存款金额
4. 确认交易并等待区块链确认

### 3. 借款
1. 确保有足够的存款作为抵押
2. 在"市场"标签页选择要借出的资产
3. 点击"借款"按钮
4. 输入借款金额（不超过可用额度）
5. 确认交易

### 4. 管理持仓
1. 切换到"我的持仓"标签页
2. 查看所有存款和借款
3. 使用"取款"按钮取出存款
4. 使用"还款"按钮偿还借款

## 技术栈

- **React 18**: UI框架
- **TypeScript**: 类型安全
- **Ethers.js**: 区块链交互
- **Tailwind CSS**: 样式框架
- **Axios**: HTTP请求

## API集成

### 后端API
- `GET /health`: 系统健康状态
- `GET /markets`: 获取所有市场
- `GET /accounts/:address`: 获取账户数据
- `GET /events`: 获取交易事件

### 智能合约交互
- **LendingToken**: 存款、取款、借款、还款
- **Comptroller**: 市场管理、健康度检查
- **ERC20**: 代币授权和余额查询

## 关键特性

### 实时数据更新
- 市场数据每30秒自动刷新
- 账户数据每15秒自动刷新
- 交易后立即更新

### 用户体验
- 响应式设计，支持移动端
- 加载状态反馈
- 错误提示
- 交易成功提示

### 安全性
- 钱包签名验证
- 交易前余额检查
- 健康度监控
- 清算风险提示

## 开发说明

### 环境变量
```bash
VITE_API_URL=/api  # 后端API地址
```

### 本地开发
```bash
cd frontend
npm install
npm run dev
```

### 构建生产版本
```bash
npm run build
```

## 注意事项

1. **抵押率**: 保持足够的抵押率以避免清算
2. **Gas费用**: 每次链上操作都需要支付gas费用
3. **网络延迟**: 交易确认可能需要几秒到几分钟
4. **授权**: 首次使用需要授权代币使用权限

## 风险提示

- 智能合约风险
- 市场波动风险
- 清算风险
- 网络风险

⚠️ 请在充分了解风险的情况下使用本协议
